<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module      : Ch09.Ex05
Description : &#32244;&#32722;&#21839;&#38988; 9.5
Copyright   : (c) Nobuo Yamashita, 2019
License     : BSD-3
Maintainer  : nobsun@gmail.com

&#38306;&#25968; @choices@&#65292;@exprs@&#65292;@eval@ &#12434;&#29992;&#12356;&#12390;&#65292;1&#65292;3&#65292;7&#65292;1&#65292;25&#65292;50 &#12395;&#23550;&#12377;&#12427;&#21487;&#33021;&#12394;&#24335;&#12399; 33,665,406 &#20491;&#12354;&#12426;&#65292;&#12381;&#12398;&#12358;&#12385; 4,672,540 &#20491;&#12398;&#12415;&#12364;&#26377;&#21177;&#12391;&#12354;&#12427;&#12371;&#12392;&#12434;&#30906;
&#12363;&#12417;&#12390;&#12367;&#12384;&#12373;&#12356;
-}</span><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ch09.Ex05</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Ch09.CountDown.html"><span class="hs-identifier">Ch09.CountDown</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Ch09.CountDown.html#eval"><span class="hs-identifier hs-var">eval</span></a><span class="hs-special">,</span><span> </span><a href="Ch09.CountDown.html#valid"><span class="hs-identifier hs-var">valid</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">{- $setup

&gt;&gt;&gt; ns = [1,3,7,10,25,50]
-}</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">{- |
  &#35413;&#20385;&#22120;

&gt;&gt;&gt; length [ e | ns' &lt;- choices ns, e &lt;- exprs ns', _ &lt;- eval e ]
10839369
-}</span><span>
</span><a name="line-26"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch09.CountDown.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-27"></a><a name="eval"><a href="Ch09.Ex05.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch09.CountDown.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><a name="local-6989586621679067038"><a href="#local-6989586621679067038"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679067038"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-28"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Ch09.CountDown.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679067039"><a href="#local-6989586621679067039"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679067040"><a href="#local-6989586621679067040"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679067041"><a href="#local-6989586621679067041"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Ch09.CountDown.html#apply"><span class="hs-identifier hs-var">apply</span></a><span> </span><a href="#local-6989586621679067039"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679067042"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679067043"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679067042"><a href="#local-6989586621679067042"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Ch09.Ex05.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679067040"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679067043"><a href="#local-6989586621679067043"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Ch09.Ex05.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679067041"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="Ch09.Ex05.html#valid"><span class="hs-identifier hs-var">valid</span></a><span> </span><a href="#local-6989586621679067039"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679067042"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679067043"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">{- |
  Validator

@
  valid Add x y = True
  valid Sub x y = True
  valid Mul x y = True
  valid Div x y = y /= 0 &amp;&amp; x `mod` y == 0
@
-}</span><span>
</span><a name="line-40"></a><span class="hs-identifier">valid</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch09.CountDown.html#Op"><span class="hs-identifier hs-type">Op</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-41"></a><a name="valid"><a href="Ch09.Ex05.html#valid"><span class="hs-identifier">valid</span></a></a><span> </span><a href="Ch09.CountDown.html#Add"><span class="hs-identifier hs-var">Add</span></a><span> </span><a name="local-6989586621679067044"><a href="#local-6989586621679067044"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679067045"><a href="#local-6989586621679067045"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-42"></a><span class="hs-identifier">valid</span><span> </span><a href="Ch09.CountDown.html#Sub"><span class="hs-identifier hs-var">Sub</span></a><span> </span><a name="local-6989586621679067046"><a href="#local-6989586621679067046"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679067047"><a href="#local-6989586621679067047"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-43"></a><span class="hs-identifier">valid</span><span> </span><a href="Ch09.CountDown.html#Mul"><span class="hs-identifier hs-var">Mul</span></a><span> </span><a name="local-6989586621679067048"><a href="#local-6989586621679067048"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679067049"><a href="#local-6989586621679067049"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-44"></a><span class="hs-identifier">valid</span><span> </span><a href="Ch09.CountDown.html#Div"><span class="hs-identifier hs-var">Div</span></a><span> </span><a name="local-6989586621679067050"><a href="#local-6989586621679067050"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679067051"><a href="#local-6989586621679067051"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679067051"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679067050"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679067051"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-45"></a></pre></body></html>