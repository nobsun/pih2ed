<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module      : Ch08.Ex08
Description : &#32244;&#32722;&#21839;&#38988; 8.8
Copyright   : (c) Nobuo Yamashita, 2019
License     : BSD-3
Maintainer  : nobsun@gmail.com

-}</span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ch08.Ex08</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- import Ch07.Ex07 (int2bin)</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-comment">{- |
  &#21629;&#38988;
-}</span><span>
</span><a name="line-16"></a><span class="hs-keyword">data</span><span> </span><a name="Prop"><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier">Prop</span></a></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Const"><a href="Ch08.Ex08.html#Const"><span class="hs-identifier">Const</span></a></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Var"><a href="Ch08.Ex08.html#Var"><span class="hs-identifier">Var</span></a></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Not"><a href="Ch08.Ex08.html#Not"><span class="hs-identifier">Not</span></a></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="And"><a href="Ch08.Ex08.html#And"><span class="hs-identifier">And</span></a></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Or"><a href="Ch08.Ex08.html#Or"><span class="hs-identifier">Or</span></a></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Imply"><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier">Imply</span></a></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Equiv"><a href="Ch08.Ex08.html#Equiv"><span class="hs-identifier">Equiv</span></a></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">{- |
  &#21629;&#38988;1

&gt;&gt;&gt; p1
And (Var 'A') (Not (Var 'A'))
-}</span><span>
</span><a name="line-32"></a><span class="hs-identifier">p1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-33"></a><a name="p1"><a href="Ch08.Ex08.html#p1"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Not"><span class="hs-identifier hs-var">Not</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">{-|
  &#21629;&#38988;2

&gt;&gt;&gt; p2
Imply (And (Var 'A') (Var 'B')) (Var 'A')
-}</span><span>
</span><a name="line-41"></a><span class="hs-identifier">p2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-42"></a><a name="p2"><a href="Ch08.Ex08.html#p2"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'B'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">{-|
  &#21629;&#38988;3

&gt;&gt;&gt; p3
Imply (Var 'A') (And (Var 'A') (Var 'B'))
-}</span><span>
</span><a name="line-50"></a><span class="hs-identifier">p3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-51"></a><a name="p3"><a href="Ch08.Ex08.html#p3"><span class="hs-identifier">p3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'B'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">{- |
  &#21629;&#38988;4

&gt;&gt;&gt; p4
Imply (And (Var 'A') (Imply (Var 'A') (Var 'B'))) (Var 'B')
-}</span><span>
</span><a name="line-59"></a><span class="hs-identifier">p4</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span>
</span><a name="line-60"></a><a name="p4"><a href="Ch08.Ex08.html#p4"><span class="hs-identifier">p4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'A'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'B'</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-char">'B'</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{- |
  &#32622;&#25563;&#34920;
-}</span><span>
</span><a name="line-65"></a><span class="hs-keyword">type</span><span> </span><a name="Assoc"><a href="Ch08.Ex08.html#Assoc"><span class="hs-identifier">Assoc</span></a></a><span> </span><a name="local-6989586621679065139"><a href="#local-6989586621679065139"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679065140"><a href="#local-6989586621679065140"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679065139"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065140"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-identifier">find</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679065142"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679065142"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ch08.Ex08.html#Assoc"><span class="hs-identifier hs-type">Assoc</span></a><span> </span><a href="#local-6989586621679065142"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679065143"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065143"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-68"></a><a name="find"><a href="Ch08.Ex08.html#find"><span class="hs-identifier">find</span></a></a><span> </span><a name="local-6989586621679065144"><a href="#local-6989586621679065144"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679065145"><a href="#local-6989586621679065145"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065147"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065146"><a href="#local-6989586621679065146"><span class="hs-identifier">k'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065147"><a href="#local-6989586621679065147"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679065145"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065144"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065146"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">]</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-keyword">type</span><span> </span><a name="Subst"><a href="Ch08.Ex08.html#Subst"><span class="hs-identifier">Subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#Assoc"><span class="hs-identifier hs-type">Assoc</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-73"></a><a name="eval"><a href="Ch08.Ex08.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Const"><span class="hs-identifier hs-var">Const</span></a><span> </span><a name="local-6989586621679065148"><a href="#local-6989586621679065148"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065148"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-74"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065149"><a href="#local-6989586621679065149"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679065150"><a href="#local-6989586621679065150"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679065150"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065149"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-75"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065151"><a href="#local-6989586621679065151"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Not"><span class="hs-identifier hs-var">Not</span></a><span> </span><a name="local-6989586621679065152"><a href="#local-6989586621679065152"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065151"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065152"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065153"><a href="#local-6989586621679065153"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><a name="local-6989586621679065154"><a href="#local-6989586621679065154"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065155"><a href="#local-6989586621679065155"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065153"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065154"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065153"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065155"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-77"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065156"><a href="#local-6989586621679065156"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Or"><span class="hs-identifier hs-var">Or</span></a><span> </span><a name="local-6989586621679065157"><a href="#local-6989586621679065157"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065158"><a href="#local-6989586621679065158"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065156"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065157"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065156"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-78"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065159"><a href="#local-6989586621679065159"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><a name="local-6989586621679065160"><a href="#local-6989586621679065160"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065161"><a href="#local-6989586621679065161"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065159"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065160"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065159"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-79"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679065162"><a href="#local-6989586621679065162"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Equiv"><span class="hs-identifier hs-var">Equiv</span></a><span> </span><a name="local-6989586621679065163"><a href="#local-6989586621679065163"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065164"><a href="#local-6989586621679065164"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065163"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065164"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">{- |
  &#22793;&#25968;&#12398;&#20986;&#29694;&#12522;&#12473;&#12488;

&gt;&gt;&gt; vars p2 == ['A','B','A']
True
-}</span><span>
</span><a name="line-87"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-88"></a><a name="vars"><a href="Ch08.Ex08.html#vars"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Const"><span class="hs-identifier hs-var">Const</span></a><span> </span><a name="local-6989586621679065165"><a href="#local-6989586621679065165"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-89"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679065166"><a href="#local-6989586621679065166"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065166"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-90"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Not"><span class="hs-identifier hs-var">Not</span></a><span> </span><a name="local-6989586621679065167"><a href="#local-6989586621679065167"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065167"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-91"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><a name="local-6989586621679065168"><a href="#local-6989586621679065168"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065169"><a href="#local-6989586621679065169"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065169"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-92"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Or"><span class="hs-identifier hs-var">Or</span></a><span> </span><a name="local-6989586621679065170"><a href="#local-6989586621679065170"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065171"><a href="#local-6989586621679065171"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065170"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065171"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-93"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Imply"><span class="hs-identifier hs-var">Imply</span></a><span> </span><a name="local-6989586621679065172"><a href="#local-6989586621679065172"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065173"><a href="#local-6989586621679065173"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065172"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065173"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#Equiv"><span class="hs-identifier hs-var">Equiv</span></a><span> </span><a name="local-6989586621679065174"><a href="#local-6989586621679065174"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679065175"><a href="#local-6989586621679065175"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065174"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065175"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">{- |
  &#25351;&#23450;&#12375;&#12383;&#38263;&#12373;&#12398;&#30495;&#29702;&#20516;&#12522;&#12473;&#12488;

&gt;&gt;&gt; bools 3
[[False,False,False],[False,False,True],[False,True,False],[False,True,True],[True,False,False],[True,False,True],[True,True,False],[True,True,True]]
-}</span><span>
</span><a name="line-102"></a><span class="hs-identifier">bools</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-103"></a><a name="bools"><a href="Ch08.Ex08.html#bools"><span class="hs-identifier">bools</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span class="hs-identifier">bools</span><span> </span><a name="local-6989586621679065176"><a href="#local-6989586621679065176"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065177"><span class="hs-identifier hs-var">bss</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065177"><span class="hs-identifier hs-var">bss</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-6989586621679065177"><a href="#local-6989586621679065177"><span class="hs-identifier">bss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#bools"><span class="hs-identifier hs-var">bools</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065176"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">{- |
  &#32622;&#25563;&#12522;&#12473;&#12488;

&gt;&gt;&gt; substs p2
[[('A',False),('B',False)],[('A',False),('B',True)],[('A',True),('B',False)],[('A',True),('B',True)]]
-}</span><span>
</span><a name="line-114"></a><span class="hs-identifier">substs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch08.Ex08.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span class="hs-special">]</span><span>
</span><a name="line-115"></a><a name="substs"><a href="Ch08.Ex08.html#substs"><span class="hs-identifier">substs</span></a></a><span> </span><a name="local-6989586621679065178"><a href="#local-6989586621679065178"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679065179"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#bools"><span class="hs-identifier hs-var">bools</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679065179"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-6989586621679065179"><a href="#local-6989586621679065179"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch08.Ex08.html#rmdups"><span class="hs-identifier hs-var">rmdups</span></a><span> </span><span class="hs-special">(</span><a href="Ch08.Ex08.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679065178"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">rmdups</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679065141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065141"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065141"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-120"></a><a name="rmdups"><a href="Ch08.Ex08.html#rmdups"><span class="hs-identifier">rmdups</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-121"></a><span class="hs-identifier">rmdups</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065180"><a href="#local-6989586621679065180"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065181"><a href="#local-6989586621679065181"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065180"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Ch08.Ex08.html#rmdups"><span class="hs-identifier hs-var">rmdups</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679065180"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065181"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">{- |
  &#24658;&#30495;&#26908;&#26619;&#22120;

&gt;&gt;&gt; isTaut p1
False
&gt;&gt;&gt; isTaut p2
True
&gt;&gt;&gt; isTaut p3
False
&gt;&gt;&gt; isTaut p4
True
&gt;&gt;&gt; p5 = Or p1 (Not p1)
&gt;&gt;&gt; isTaut p5
True
&gt;&gt;&gt; p6 = Equiv p1 p3
&gt;&gt;&gt; isTaut p6
False
-}</span><span>
</span><a name="line-141"></a><span class="hs-identifier">isTaut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Ch08.Ex08.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-142"></a><a name="isTaut"><a href="Ch08.Ex08.html#isTaut"><span class="hs-identifier">isTaut</span></a></a><span> </span><a name="local-6989586621679065182"><a href="#local-6989586621679065182"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span> </span><a href="Ch08.Ex08.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679065182"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679065183"><a href="#local-6989586621679065183"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Ch08.Ex08.html#substs"><span class="hs-identifier hs-var">substs</span></a><span> </span><a href="#local-6989586621679065182"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a></pre></body></html>