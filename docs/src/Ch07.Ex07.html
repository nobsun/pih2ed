<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module      : Ch07.Ex07
Description : &#32244;&#32722;&#21839;&#38988; 7.7
Copyright   : (c) Nobuo Yamashita, 2019
License     : BSD-3
Maintainer  : nobsun@gmail.com

&#12497;&#12522;&#12486;&#12451;&#12540;&#12499;&#12483;&#12488;&#12398;&#27010;&#24565;&#12434;&#29992;&#12356;&#12390;&#65292;&#25991;&#23383;&#21015;&#12398;&#20108;&#36914;&#25968;&#12408;&#12398;&#22793;&#25563;&#22120;&#12364;&#21336;&#32020;&#12394;&#36890;&#20449;&#12456;&#12521;&#12540;&#12434;&#26908;&#20986;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#25913;&#33391;&#12375;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;
&#20855;&#20307;&#30340;&#12395;&#12399;&#65292;&#31526;&#21495;&#21270;&#12391;&#29983;&#25104;&#12373;&#12428;&#12383; 8 &#12499;&#12483;&#12488;&#12398;&#20108;&#36914;&#25968;&#12395;&#65292; 1 &#12398;&#25968;&#12364;&#22855;&#25968;&#12394;&#12425; 1 &#65292;&#12381;&#12358;&#12391;&#12394;&#12356;&#12394;&#12425; 0 &#12395;&#12394;&#12427;&#12497;&#12522;&#12486;&#12451;&#12540;&#12499;&#12483;&#12488;&#12434;&#20184;&#21152;&#12375;&#12414;&#12377;&#65294;
&#36870;&#12395;&#24489;&#21495;&#12398;&#38555;&#12399; 9 &#12499;&#12483;&#12488;&#12398;&#20108;&#36914;&#25968;&#12398;&#12497;&#12522;&#12486;&#12451;&#12540;&#12499;&#12483;&#12488;&#12364;&#27491;&#12375;&#12356;&#12363;&#12434;&#26908;&#26619;&#12375;&#65292;&#27491;&#12375;&#12369;&#12428;&#12400;&#12497;&#12522;&#12486;&#12451;&#12540;&#12499;&#12483;&#12488;&#12434;&#25448;&#12390;&#65292;
&#35492;&#12426;&#12391;&#12354;&#12428;&#12400;&#12497;&#12522;&#12486;&#12451;&#12540;&#12456;&#12521;&#12540;&#12434;&#22577;&#21578;&#12377;&#12427;&#12424;&#12358;&#12395;&#12375;&#12414;&#12377;&#12290;
-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ch07.Ex07</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bool</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Codec.Binary.UTF8.String</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">U</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Ch07.Ex06.html"><span class="hs-identifier">Ch07.Ex06</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Ch07.Ex06.html#map"><span class="hs-identifier hs-var">map</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">{- |
  &#22411;&#22793;&#25563; Word8 &#8594; Int
-}</span><span>
</span><a name="line-24"></a><span class="hs-identifier">byte2int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-25"></a><a name="byte2int"><a href="Ch07.Ex07.html#byte2int"><span class="hs-identifier">byte2int</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">{- |
  &#22411;&#22793;&#25563; Int &#8594; Word8
-}</span><span>
</span><a name="line-30"></a><span class="hs-identifier">int2byte</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word8</span><span>
</span><a name="line-31"></a><a name="int2byte"><a href="Ch07.Ex07.html#int2byte"><span class="hs-identifier">int2byte</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">{- |
  Int&#12363;&#12425;Bit&#21015;&#12408;&#22793;&#25563;
-}</span><span>
</span><a name="line-36"></a><span class="hs-identifier">int2bin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-37"></a><a name="int2bin"><a href="Ch07.Ex07.html#int2bin"><span class="hs-identifier">int2bin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch07.Ex06.html#unfold"><span class="hs-identifier hs-var">unfold</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">{- |
  Bit&#21015;&#12363;&#12425;Int&#12408;&#22793;&#25563;
-}</span><span>
</span><a name="line-42"></a><span class="hs-identifier">bin2int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-43"></a><a name="bin2int"><a href="Ch07.Ex07.html#bin2int"><span class="hs-identifier">bin2int</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679063438"><span class="hs-identifier hs-var">&#966;</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>    </span><a name="local-6989586621679063438"><a href="#local-6989586621679063438"><span class="hs-identifier">&#966;</span></a></a><span> </span><a name="local-6989586621679063439"><a href="#local-6989586621679063439"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679063440"><a href="#local-6989586621679063440"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063439"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679063440"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">{- |
  &#25351;&#23450;&#12375;&#12383;&#24133;&#12395;Bit&#21015;&#12434;&#35519;&#25972;
-}</span><span>
</span><a name="line-50"></a><span class="hs-identifier">make</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-51"></a><a name="make"><a href="Ch07.Ex07.html#make"><span class="hs-identifier">make</span></a></a><span> </span><a name="local-6989586621679063441"><a href="#local-6989586621679063441"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679063441"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">{- |
  &#25991;&#23383;&#21015;&#12434;Bit&#21015;&#12395;&#31526;&#21495;
-}</span><span>
</span><a name="line-56"></a><span class="hs-identifier">encode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-57"></a><a name="encode"><a href="Ch07.Ex07.html#encode"><span class="hs-identifier">encode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Ch07.Ex07.html#make"><span class="hs-identifier hs-var">make</span></a><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#int2bin"><span class="hs-identifier hs-var">int2bin</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#byte2int"><span class="hs-identifier hs-var">byte2int</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">U.encode</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">{- |
  Bit&#21015;&#12434;&#25991;&#23383;&#21015;&#12395;&#24489;&#21495;
-}</span><span>
</span><a name="line-62"></a><span class="hs-identifier">decode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-63"></a><a name="decode"><a href="Ch07.Ex07.html#decode"><span class="hs-identifier">decode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">U.decode</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Ch07.Ex07.html#int2byte"><span class="hs-identifier hs-var">int2byte</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#bin2int"><span class="hs-identifier hs-var">bin2int</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#chop"><span class="hs-identifier hs-var">chop</span></a><span> </span><span class="hs-number">8</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">{- |
  &#25351;&#23450;&#12375;&#12383;&#12499;&#12483;&#12488;&#25968;&#12398;&#12499;&#12483;&#12488;&#21015;&#12395;&#20998;&#35299;
-}</span><span>
</span><a name="line-68"></a><span class="hs-identifier">chop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-69"></a><a name="chop"><a href="Ch07.Ex07.html#chop"><span class="hs-identifier">chop</span></a></a><span> </span><a name="local-6989586621679063442"><a href="#local-6989586621679063442"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch07.Ex06.html#unfold"><span class="hs-identifier hs-var">unfold</span></a><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679063442"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621679063442"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">{- |
  &#25991;&#23383;&#21015;&#12434;Bit&#21015;&#12395;&#31526;&#21495;&#12375;&#12383;&#19978;&#12391;&#65292;8bit&#12372;&#12392;&#12395;&#12481;&#12455;&#12483;&#12463;&#12499;&#12483;&#12488;1&#12499;&#12483;&#12488;&#36861;&#21152;

&gt;&gt;&gt; send &quot;&#21566;&#36649;&#12399;&#29483;&#12391;&#12354;&#12427;&quot;
[1,1,0,1,0,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,0,1,0,1,1,1,1,0,0,1,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,1,0,0,0,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,1,0,1,0,1,0,1,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,0,0,1,1,1,0,1,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,1,1,1,1,0,0,0,1,1,1,0,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,1,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1]
-}</span><span>
</span><a name="line-77"></a><span class="hs-identifier">send</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-78"></a><a name="send"><a href="Ch07.Ex07.html#send"><span class="hs-identifier">send</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Ch07.Ex07.html#addCB"><span class="hs-identifier hs-var">addCB</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#chop"><span class="hs-identifier hs-var">chop</span></a><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#encode"><span class="hs-identifier hs-var">encode</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">{- |
  @send@&#12364;&#29983;&#25104;&#12375;&#12383;&#12499;&#12483;&#12488;&#21015;&#12434;&#12481;&#12455;&#12483;&#12463;&#12499;&#12483;&#12488;&#12434;&#12481;&#12455;&#12483;&#12463;&#12375;&#12383;&#19978;&#12391;&#65292;&#25991;&#23383;&#21015;&#12395;&#24489;&#21495;

&gt;&gt;&gt; recv (send &quot;&#21566;&#36649;&#12399;&#29483;&#12391;&#12354;&#12427;&quot;)
&quot;&#21566;&#36649;&#12399;&#29483;&#12391;&#12354;&#12427;&quot;
-}</span><span>
</span><a name="line-86"></a><span class="hs-identifier">recv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-87"></a><a name="recv"><a href="Ch07.Ex07.html#recv"><span class="hs-identifier">recv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch07.Ex07.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Ch07.Ex07.html#chkCB"><span class="hs-identifier hs-var">chkCB</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#chop"><span class="hs-identifier hs-var">chop</span></a><span> </span><span class="hs-number">9</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">{- |
  &#36890;&#20449;&#36335;
-}</span><span>
</span><a name="line-92"></a><span class="hs-identifier">transmit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-93"></a><a name="transmit"><a href="Ch07.Ex07.html#transmit"><span class="hs-identifier">transmit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">{- |
  &#12481;&#12455;&#12483;&#12463;&#12499;&#12483;&#12488;
-}</span><span>
</span><a name="line-98"></a><span class="hs-identifier">checkBit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>
</span><a name="line-99"></a><a name="checkBit"><a href="Ch07.Ex07.html#checkBit"><span class="hs-identifier">checkBit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">sum</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">{- |
  &#12481;&#12455;&#12483;&#12463;&#12499;&#12483;&#12488;&#12398;&#36861;&#21152;
-}</span><span>
</span><a name="line-104"></a><span class="hs-identifier">addCB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-105"></a><a name="addCB"><a href="Ch07.Ex07.html#addCB"><span class="hs-identifier">addCB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Ch07.Ex07.html#checkBit"><span class="hs-identifier hs-var">checkBit</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">{- |
  &#12481;&#12455;&#12483;&#12463;&#12499;&#12483;&#12488;&#12391;&#12499;&#12483;&#12488;&#21015;&#12434;&#26908;&#26619;
-}</span><span>
</span><a name="line-110"></a><span class="hs-identifier">check</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-111"></a><a name="check"><a href="Ch07.Ex07.html#check"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Ch07.Ex07.html#checkBit"><span class="hs-identifier hs-var">checkBit</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">tail</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">{- |
  &#12499;&#12483;&#12488;&#21015;&#12398;&#12481;&#12455;&#12483;&#12463;
-}</span><span>
</span><a name="line-116"></a><span class="hs-identifier">chkCB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Ch07.Ex06.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span>
</span><a name="line-117"></a><a name="chkCB"><a href="Ch07.Ex07.html#chkCB"><span class="hs-identifier">chkCB</span></a></a><span> </span><a name="local-6989586621679063443"><a href="#local-6989586621679063443"><span class="hs-identifier">bits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bool</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error!&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679063443"><span class="hs-identifier hs-var">bits</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ch07.Ex07.html#check"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621679063443"><span class="hs-identifier hs-var">bits</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a></pre></body></html>