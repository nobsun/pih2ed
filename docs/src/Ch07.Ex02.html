<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module      : Ch07.Ex02
Description : &#32244;&#32722;&#21839;&#38988; 7.2
Copyright   : (c) Nobuo Yamashita, 2019
License     : BSD-3
Maintainer  : nobsun@gmail.com

&#12503;&#12524;&#12522;&#12517;&#12540;&#12489;&#12391;&#12398;&#23450;&#32681;&#12434;&#35211;&#12394;&#12356;&#12391;&#20197;&#19979;&#12398;&#39640;&#38542;&#38306;&#25968;&#12434;&#23450;&#32681;&#12375;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;

a. &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12398;&#12377;&#12409;&#12390;&#12364;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;
@
  all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool
@

b. &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12398;&#12393;&#12428;&#12363;&#12364;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;
@
  any :: (a -&gt; Bool) -&gt; [a] -&gt; Bool
@

c. &#12522;&#12473;&#12488;&#12398;&#20808;&#38957;&#12363;&#12425;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#36899;&#32154;&#12375;&#12383;&#35201;&#32032;&#12434;&#21462;&#12426;&#20986;&#12377;&#38306;&#25968;
@
  takeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]
@

d. &#12522;&#12473;&#12488;&#12398;&#20808;&#38957;&#12363;&#12425;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#36899;&#32154;&#12375;&#12383;&#35201;&#32032;&#12434;&#21462;&#12426;&#38500;&#12367;&#38306;&#25968;
@
  dropWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]
@
-}</span><span>
</span><a name="line-30"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ch07.Ex02</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">any</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12398;&#12377;&#12409;&#12390;&#12364;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;

@
  all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool
  all p = foldr ((&amp;&amp;) . p) True
@

-}</span><span>
</span><a name="line-43"></a><span class="hs-identifier">all</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062027"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-44"></a><a name="all"><a href="Ch07.Ex02.html#all"><span class="hs-identifier">all</span></a></a><span> </span><a name="local-6989586621679062028"><a href="#local-6989586621679062028"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679062028"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12398;&#12393;&#12428;&#12363;&#12364;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;

@
  any p = foldr ((||) . p) False
@
-}</span><span>
</span><a name="line-53"></a><span class="hs-identifier">any</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062026"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062026"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-54"></a><a name="any"><a href="Ch07.Ex02.html#any"><span class="hs-identifier">any</span></a></a><span> </span><a name="local-6989586621679062029"><a href="#local-6989586621679062029"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">||</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679062029"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#20808;&#38957;&#12363;&#12425;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#36899;&#32154;&#12375;&#12383;&#35201;&#32032;&#12434;&#21462;&#12426;&#20986;&#12377;&#38306;&#25968;

@
  takeWhile p = foldr &#966; []
    where
      &#966; x xs | p x       = x : xs
              | otherwise = []
@
-}</span><span>
</span><a name="line-66"></a><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-67"></a><a name="takeWhile"><a href="Ch07.Ex02.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></a><span> </span><a name="local-6989586621679062030"><a href="#local-6989586621679062030"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679062031"><span class="hs-identifier hs-var">&#966;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>    </span><a name="local-6989586621679062031"><a href="#local-6989586621679062031"><span class="hs-identifier">&#966;</span></a></a><span> </span><a name="local-6989586621679062032"><a href="#local-6989586621679062032"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679062033"><a href="#local-6989586621679062033"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062030"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679062032"><span class="hs-identifier hs-var">x</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062032"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679062033"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-70"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#20808;&#38957;&#12363;&#12425;&#36848;&#35486;&#12434;&#28288;&#12383;&#12377;&#36899;&#32154;&#12375;&#12383;&#35201;&#32032;&#12434;&#21462;&#12426;&#38500;&#12367;&#38306;&#25968;

@
  dropWhile p = para &#966; []
    where
      &#966; x (xs, ys)
        | p x       = ys
        | otherwise = x:xs

  para :: (a -&gt; ([a], b) -&gt; b) -&gt; b -&gt; [a] -&gt; b
  para _  z []     = z
  para &#966; z (x:xs) = &#966; x (xs, para &#966; z xs)
@

-}</span><span>
</span><a name="line-87"></a><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062024"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062024"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-88"></a><a name="dropWhile"><a href="Ch07.Ex02.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></a><span> </span><a name="local-6989586621679062034"><a href="#local-6989586621679062034"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ch07.Ex02.html#para"><span class="hs-identifier hs-var">para</span></a><span> </span><a href="#local-6989586621679062035"><span class="hs-identifier hs-var">&#966;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-6989586621679062035"><a href="#local-6989586621679062035"><span class="hs-identifier">&#966;</span></a></a><span> </span><a name="local-6989586621679062036"><a href="#local-6989586621679062036"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679062037"><a href="#local-6989586621679062037"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062038"><a href="#local-6989586621679062038"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062034"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">x</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-92"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679062037"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-identifier">para</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062023"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062023"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062023"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062023"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-95"></a><a name="para"><a href="Ch07.Ex02.html#para"><span class="hs-identifier">para</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621679062039"><a href="#local-6989586621679062039"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062039"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-96"></a><span class="hs-identifier">para</span><span> </span><a name="local-6989586621679062040"><a href="#local-6989586621679062040"><span class="hs-identifier">&#966;</span></a></a><span> </span><a name="local-6989586621679062041"><a href="#local-6989586621679062041"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679062042"><a href="#local-6989586621679062042"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679062043"><a href="#local-6989586621679062043"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062040"><span class="hs-identifier hs-var">&#966;</span></a><span> </span><a href="#local-6989586621679062042"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062043"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Ch07.Ex02.html#para"><span class="hs-identifier hs-var">para</span></a><span> </span><a href="#local-6989586621679062040"><span class="hs-identifier hs-var">&#966;</span></a><span> </span><a href="#local-6989586621679062041"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679062043"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a></pre></body></html>