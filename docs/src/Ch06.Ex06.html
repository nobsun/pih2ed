<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module      : Ch06.Ex06
Description : &#32244;&#32722;&#21839;&#38988; 6.6
Copyright   : (c) Nobuo Yamashita, 2019
License     : BSD-3
Maintainer  : nobsun@gmail.com

&#12503;&#12524;&#12522;&#12517;&#12540;&#12489;&#12434;&#35211;&#12394;&#12356;&#12391;&#65292;&#12522;&#12473;&#12488;&#12395;&#23550;&#12377;&#12427;&#20197;&#19979;&#12398;&#12503;&#12524;&#12522;&#12517;&#12540;&#12489;&#38306;&#25968;&#12434;&#20877;&#24112;&#12434;&#20351;&#12387;&#12390;&#23450;&#32681;&#12375;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;

a. &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12364;&#12377;&#12409;&#12390; True &#12391;&#12354;&#12427;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968; @and :: [Bool] -&gt; Bool@

b. &#12522;&#12473;&#12488;&#12398;&#12522;&#12473;&#12488;&#12434;&#21462;&#12426;&#65292;&#35201;&#32032;&#12391;&#12354;&#12427;&#12522;&#12473;&#12488;&#12434;&#36899;&#32080;&#12377;&#12427;&#38306;&#25968; @concat :: [[a]] -&gt; [a]@

c. &#25351;&#23450;&#12373;&#12428;&#12383;&#35201;&#32032;&#12434; n &#20491;&#25345;&#12388;&#12522;&#12473;&#12488;&#12434;&#29983;&#25104;&#12377;&#12427;&#38306;&#25968; @replicate :: Int -&gt; a -&gt; [a]@

d. &#31354;&#12391;&#12394;&#12356;&#12522;&#12473;&#12488;&#12398; n &#30058;&#12417;&#12398;&#35201;&#32032;&#12434;&#21462;&#12426;&#20986;&#12377;&#38306;&#25968; @(!!) :: [a] -&gt; Int -&gt; a@

e. &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12395;&#21547;&#12414;&#12428;&#12427;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968; @elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool@

-}</span><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ch06.Ex06</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">and</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">replicate</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elem</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12364;&#12377;&#12409;&#12390; True &#12391;&#12354;&#12427;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;
-}</span><span>
</span><a name="line-28"></a><span class="hs-identifier">and</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-29"></a><a name="and"><a href="Ch06.Ex06.html#and"><span class="hs-identifier">and</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-30"></a><span class="hs-identifier">and</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679061476"><a href="#local-6989586621679061476"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679061477"><a href="#local-6989586621679061477"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061476"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Ch06.Ex06.html#and"><span class="hs-identifier hs-var">and</span></a><span> </span><a href="#local-6989586621679061477"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#12522;&#12473;&#12488;&#12434;&#21462;&#12426;&#65292;&#35201;&#32032;&#12391;&#12354;&#12427;&#12522;&#12473;&#12488;&#12434;&#36899;&#32080;&#12377;&#12427;&#38306;&#25968;
-}</span><span>
</span><a name="line-35"></a><span class="hs-identifier">concat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679061475"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679061475"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-36"></a><a name="concat"><a href="Ch06.Ex06.html#concat"><span class="hs-identifier">concat</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span class="hs-identifier">concat</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679061478"><a href="#local-6989586621679061478"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679061479"><a href="#local-6989586621679061479"><span class="hs-identifier">xss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061478"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Ch06.Ex06.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="#local-6989586621679061479"><span class="hs-identifier hs-var">xss</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">{- |
  &#25351;&#23450;&#12373;&#12428;&#12383;&#35201;&#32032;&#12434; n &#20491;&#25345;&#12388;&#12522;&#12473;&#12488;&#12434;&#29983;&#25104;&#12377;&#12427;&#38306;&#25968;
-}</span><span>
</span><a name="line-42"></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061474"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679061474"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-43"></a><a name="replicate"><a href="Ch06.Ex06.html#replicate"><span class="hs-identifier">replicate</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span class="hs-identifier">replicate</span><span> </span><a name="local-6989586621679061480"><a href="#local-6989586621679061480"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679061481"><a href="#local-6989586621679061481"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061481"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Ch06.Ex06.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061480"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061481"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">{- |
  &#31354;&#12391;&#12394;&#12356;&#12522;&#12473;&#12488;&#12398; n &#30058;&#12417;&#12398;&#35201;&#32032;&#12434;&#21462;&#12426;&#20986;&#12377;&#38306;&#25968;
-}</span><span>
</span><a name="line-49"></a><span class="hs-special">(</span><span class="hs-operator">!!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679061473"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061473"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-50"></a><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="%21%21"><a href="Ch06.Ex06.html#%21%21"><span class="hs-operator">!!</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;index out of range&quot;</span><span>
</span><a name="line-51"></a><span class="hs-special">(</span><a name="local-6989586621679061482"><a href="#local-6989586621679061482"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-operator">!!</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061482"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-52"></a><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679061483"><a href="#local-6989586621679061483"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">!!</span><span> </span><a name="local-6989586621679061484"><a href="#local-6989586621679061484"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061483"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Ch06.Ex06.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061484"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">{- |
  &#12522;&#12473;&#12488;&#12398;&#35201;&#32032;&#12395;&#21547;&#12414;&#12428;&#12427;&#12363;&#26908;&#26619;&#12377;&#12427;&#38306;&#25968;
-}</span><span>
</span><a name="line-57"></a><span class="hs-identifier">elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679061472"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061472"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679061472"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-58"></a><a name="elem"><a href="Ch06.Ex06.html#elem"><span class="hs-identifier">elem</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-59"></a><span class="hs-identifier">elem</span><span> </span><a name="local-6989586621679061485"><a href="#local-6989586621679061485"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679061486"><a href="#local-6989586621679061486"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679061487"><a href="#local-6989586621679061487"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061485"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679061486"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Ch06.Ex06.html#elem"><span class="hs-identifier hs-var">elem</span></a><span> </span><a href="#local-6989586621679061485"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061487"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a></pre></body></html>